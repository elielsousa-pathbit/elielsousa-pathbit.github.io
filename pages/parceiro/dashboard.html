<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard Parceiro - CrowdInvest</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  <link rel="stylesheet" href="../../css/style.css">
</head>
<body class="theme-parceiro">
  <div class="dashboard">
    <!-- Sidebar -->
    <aside class="sidebar sidebar-green">
      <div class="sidebar-logo">
        <a href="../../index.html" class="logo">CrowdInvest</a>
        <span class="badge" style="background: white; color: #059669; margin-left: 10px;">Parceiro</span>
      </div>
      <!-- Profile Mode Card - Elegante -->
      <div class="profile-mode-card" id="profileModeCard">
        <div class="profile-mode-current">
          <div class="profile-mode-icon emissor" id="profileIcon">
            <i class="bi bi-broadcast"></i>
          </div>
          <div class="profile-mode-info">
            <div class="profile-mode-label">Visualizando como</div>
            <div class="profile-mode-name" id="profileName">Emissor</div>
          </div>
          <span class="profile-mode-tag emissor" id="profileTag">
            <i class="bi bi-broadcast"></i> Emissor
          </span>
        </div>
        <button class="profile-mode-switch-btn" onclick="showModal('selecionarPerfilModal')">
          <i class="bi bi-arrow-left-right"></i> Trocar modo de acesso
        </button>
      </div>
      <ul class="sidebar-menu">
        <li><a href="dashboard.html" class="active"><i class="bi bi-speedometer2"></i> Dashboard</a></li>
        <li><a href="minhas-ofertas.html"><i class="bi bi-megaphone"></i> Minhas Ofertas</a></li>
        <li><a href="comunicados.html"><i class="bi bi-chat-square-text"></i> Comunicados</a></li>
        <li><a href="clientes.html"><i class="bi bi-people"></i> Clientes</a></li>
        <li><a href="investimentos.html"><i class="bi bi-wallet2"></i> Investimentos</a></li>
        <li><a href="documentos.html"><i class="bi bi-folder"></i> Documentos</a></li>
        <li><a href="imposto-renda.html"><i class="bi bi-file-earmark-text"></i> Imposto de Renda</a></li>
        <li><a href="relatorios.html"><i class="bi bi-bar-chart"></i> Relatorios</a></li>
        <li><a href="configuracoes.html"><i class="bi bi-gear"></i> Configuracoes</a></li>
        <li><a href="../parceiro-login.html"><i class="bi bi-box-arrow-left"></i> Sair</a></li>
      </ul>
    </aside>
    <div class="mobile-overlay" onclick="closeMobileMenus()"></div>

    <!-- Main Content -->
    <main class="main-content">
      <button class="menu-toggle" onclick="toggleSidebar()"><i class="bi bi-list"></i><span> Menu</span></button>

      <div class="page-header">
        <div>
          <h1 class="page-title">Ola, TechStart!</h1>
          <p class="text-muted">Acompanhe sua oferta em tempo real</p>
        </div>
        <div class="flex gap-10">
          <span class="badge badge-success">Oferta Ativa</span>
        </div>
      </div>

      <!-- Offer Status Card -->
      <div class="card" style="background: linear-gradient(135deg, #059669, #047857); color: white; margin-bottom: 30px;">
        <div class="grid-2" style="gap: 30px; align-items: center;">
          <div>
            <h2 style="margin-bottom: 10px;">TechStart Inovacao</h2>
            <p style="opacity: 0.9; margin-bottom: 20px;">Sua oferta esta 75% financiada!</p>
            <div class="progress" style="height: 12px; background: rgba(255,255,255,0.3);">
              <div class="progress-bar" style="width: 75%; background: white;"></div>
            </div>
            <div class="flex-between mt-20" style="font-size: 0.875rem;">
              <span>R$ 375.000 captados</span>
              <span>Meta: R$ 500.000</span>
            </div>
          </div>
          <div class="text-center">
            <div style="font-size: 4rem; font-weight: bold;">23</div>
            <p>dias restantes</p>
          </div>
        </div>
      </div>

      <!-- KPIs -->
      <div class="kpi-grid">
        <div class="kpi-card">
          <div class="kpi-label">Total Captado</div>
          <div class="kpi-value" style="color: var(--success);">R$ 375.000</div>
          <div class="kpi-change positive">+R$ 45.000 esta semana</div>
        </div>
        <div class="kpi-card">
          <div class="kpi-label">Clientes</div>
          <div class="kpi-value">127</div>
          <div class="kpi-change positive">+12 esta semana</div>
        </div>
        <div class="kpi-card">
          <div class="kpi-label">Ticket Medio</div>
          <div class="kpi-value">R$ 2.953</div>
          <div class="kpi-change">por investidor</div>
        </div>
        <div class="kpi-card">
          <div class="kpi-label">Em Desistencia</div>
          <div class="kpi-value" style="color: var(--warning);">3</div>
          <div class="kpi-change">R$ 8.000 em risco</div>
        </div>
      </div>

      <!-- Alert -->
      <div class="alert alert-info">
        <strong>Proximo passo:</strong> Faltam R$ 125.000 para atingir a meta. Considere intensificar a divulgacao nas proximas 3 semanas.
      </div>

      <div class="grid-2">
        <!-- Recent Investors -->
        <div class="card">
          <div class="card-header flex-between">
            <h3 class="card-title">Ultimos Clientes</h3>
            <a href="clientes.html" style="color: var(--primary);">Ver todos</a>
          </div>
          <div class="table-container">
            <table>
              <thead>
                <tr>
                  <th>Investidor</th>
                  <th>Valor</th>
                  <th>Status</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>
                    <strong>Joao S.</strong>
                    <br><small class="text-muted">19/01/2026</small>
                  </td>
                  <td>R$ 5.000</td>
                  <td><span class="badge badge-warning">Desistencia</span></td>
                </tr>
                <tr>
                  <td>
                    <strong>Maria L.</strong>
                    <br><small class="text-muted">18/01/2026</small>
                  </td>
                  <td>R$ 10.000</td>
                  <td><span class="badge badge-success">Confirmado</span></td>
                </tr>
                <tr>
                  <td>
                    <strong>Pedro M.</strong>
                    <br><small class="text-muted">17/01/2026</small>
                  </td>
                  <td>R$ 2.000</td>
                  <td><span class="badge badge-success">Confirmado</span></td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- Timeline -->
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">Cronograma da Oferta</h3>
          </div>
          <div style="display: flex; flex-direction: column; gap: 20px; padding: 10px 0;">
            <div class="flex gap-10" style="align-items: flex-start;">
              <span class="badge badge-success" style="margin-top: 2px;"><i class="bi bi-check-circle"></i> Concluido</span>
              <div>
                <strong>Inicio da Oferta</strong>
                <p class="text-muted" style="font-size: 0.875rem;">01/01/2026</p>
              </div>
            </div>
            <div class="flex gap-10" style="align-items: flex-start;">
              <span class="badge badge-success" style="margin-top: 2px;"><i class="bi bi-check-circle"></i> Concluido</span>
              <div>
                <strong>50% da Meta</strong>
                <p class="text-muted" style="font-size: 0.875rem;">10/01/2026</p>
              </div>
            </div>
            <div class="flex gap-10" style="align-items: flex-start;">
              <span class="badge badge-info" style="margin-top: 2px;"><i class="bi bi-arrow-right-circle"></i> Em Andamento</span>
              <div>
                <strong>Hoje - 75% captado</strong>
                <p class="text-muted" style="font-size: 0.875rem;">19/01/2026</p>
              </div>
            </div>
            <div class="flex gap-10" style="align-items: flex-start;">
              <span class="badge badge-secondary" style="margin-top: 2px;"><i class="bi bi-clock"></i> Pendente</span>
              <div>
                <strong>Encerramento</strong>
                <p class="text-muted" style="font-size: 0.875rem;">11/02/2026 (23 dias)</p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="grid-2">
        <!-- Captacao por Semana Chart -->
        <div class="card mt-20">
          <div class="card-header">
            <h3 class="card-title"><i class="bi bi-bar-chart"></i> Captacao por Semana</h3>
          </div>
          <div style="display: flex; align-items: flex-end; height: 180px; gap: 10px; padding: 20px;">
            <div style="flex: 1; display: flex; flex-direction: column; align-items: center;">
              <div style="background: #059669; width: 100%; height: 60px; border-radius: 4px 4px 0 0;"></div>
              <small class="text-muted" style="margin-top: 5px;">Sem 1</small>
              <small>R$ 45k</small>
            </div>
            <div style="flex: 1; display: flex; flex-direction: column; align-items: center;">
              <div style="background: #059669; width: 100%; height: 120px; border-radius: 4px 4px 0 0;"></div>
              <small class="text-muted" style="margin-top: 5px;">Sem 2</small>
              <small>R$ 95k</small>
            </div>
            <div style="flex: 1; display: flex; flex-direction: column; align-items: center;">
              <div style="background: #059669; width: 100%; height: 160px; border-radius: 4px 4px 0 0;"></div>
              <small class="text-muted" style="margin-top: 5px;">Sem 3</small>
              <small>R$ 145k</small>
            </div>
            <div style="flex: 1; display: flex; flex-direction: column; align-items: center;">
              <div style="background: #22c55e; width: 100%; height: 90px; border-radius: 4px 4px 0 0;"></div>
              <small class="text-muted" style="margin-top: 5px;">Atual</small>
              <small>R$ 90k</small>
            </div>
          </div>
        </div>

        <!-- Distribuicao de Clientes -->
        <div class="card mt-20">
          <div class="card-header">
            <h3 class="card-title"><i class="bi bi-pie-chart"></i> Clientes por Faixa</h3>
          </div>
          <div class="text-center" style="padding: 20px;">
            <div style="position: relative; width: 150px; height: 150px; border-radius: 50%; background: conic-gradient(#059669 0deg 162deg, #22c55e 162deg 270deg, #86efac 270deg 360deg); margin: 0 auto;">
              <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 80px; height: 80px; background: white; border-radius: 50%; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                <strong style="font-size: 1.1rem;">127</strong>
                <small class="text-muted">total</small>
              </div>
            </div>
            <div style="display: flex; flex-direction: column; gap: 6px; margin-top: 15px; font-size: 0.8rem;">
              <div class="flex gap-10" style="align-items: center;">
                <div style="width: 10px; height: 10px; background: #059669; border-radius: 2px;"></div>
                <span>R$ 1k-5k: 57 (45%)</span>
              </div>
              <div class="flex gap-10" style="align-items: center;">
                <div style="width: 10px; height: 10px; background: #22c55e; border-radius: 2px;"></div>
                <span>R$ 5k-10k: 38 (30%)</span>
              </div>
              <div class="flex gap-10" style="align-items: center;">
                <div style="width: 10px; height: 10px; background: #86efac; border-radius: 2px;"></div>
                <span>R$ 10k+: 32 (25%)</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>

  <!-- Modal Selecionar Perfil -->
  <div class="modal-overlay" id="selecionarPerfilModal" style="display: none;">
    <div class="modal profile-select-modal">
      <div class="modal-header">
        <h3><i class="bi bi-person-gear"></i> Modo de Acesso</h3>
        <button class="modal-close" onclick="hideModal('selecionarPerfilModal')">&times;</button>
      </div>

      <p class="text-muted mb-20">Escolha como deseja visualizar e operar na plataforma. Voce pode trocar a qualquer momento.</p>

      <!-- Opcao Emissor -->
      <div class="profile-option emissor active" id="optionEmissor" onclick="selectProfileOption('emissor')">
        <div class="profile-option-icon emissor">
          <i class="bi bi-broadcast"></i>
        </div>
        <div class="profile-option-content">
          <div class="profile-option-title">
            Emissor
            <span class="badge badge-success" style="font-size: 0.65rem;">Atual</span>
          </div>
          <p class="profile-option-desc">Crie e gerencie suas proprias ofertas de investimento. Acompanhe captacoes, investidores e comunicados.</p>
          <div class="profile-option-features">
            <span class="profile-option-feature"><i class="bi bi-check"></i> Criar ofertas</span>
            <span class="profile-option-feature"><i class="bi bi-check"></i> Gerenciar captacao</span>
            <span class="profile-option-feature"><i class="bi bi-check"></i> Comunicados</span>
            <span class="profile-option-feature"><i class="bi bi-check"></i> Ver investidores</span>
          </div>
        </div>
        <div class="profile-option-check">
          <i class="bi bi-check"></i>
        </div>
      </div>

      <!-- Opcao Distribuidor -->
      <div class="profile-option distribuidor" id="optionDistribuidor" onclick="selectProfileOption('distribuidor')">
        <div class="profile-option-icon distribuidor">
          <i class="bi bi-diagram-3"></i>
        </div>
        <div class="profile-option-content">
          <div class="profile-option-title">Distribuidor</div>
          <p class="profile-option-desc">Distribua ofertas de terceiros para sua base de clientes. Ideal para assessores e corretoras.</p>
          <div class="profile-option-features">
            <span class="profile-option-feature"><i class="bi bi-check"></i> Distribuir ofertas</span>
            <span class="profile-option-feature"><i class="bi bi-check"></i> Gerenciar clientes</span>
            <span class="profile-option-feature"><i class="bi bi-check"></i> Comissoes</span>
            <span class="profile-option-feature"><i class="bi bi-check"></i> Relatorios</span>
          </div>
        </div>
        <div class="profile-option-check">
          <i class="bi bi-check"></i>
        </div>
      </div>

      <div class="alert alert-info" style="font-size: 0.85rem;">
        <i class="bi bi-info-circle"></i> Seu acesso como <strong>Emissor + Distribuidor</strong> permite alternar entre os dois modos. As informacoes e menus serao adaptados conforme o modo selecionado.
      </div>

      <div class="flex gap-10 mt-20">
        <button class="btn btn-outline" onclick="hideModal('selecionarPerfilModal')" style="flex: 1;">Cancelar</button>
        <button class="btn btn-primary" onclick="confirmarPerfil()" style="flex: 1;">
          <i class="bi bi-check-lg"></i> Confirmar
        </button>
      </div>
    </div>
  </div>

  <script src="../../js/app.js"></script>
  <script>
    let selectedProfile = 'emissor';

    // Selecionar opcao de perfil no modal
    function selectProfileOption(profile) {
      selectedProfile = profile;

      // Atualizar visual das opcoes
      document.querySelectorAll('.profile-option').forEach(opt => {
        opt.classList.remove('active');
      });
      document.getElementById('option' + profile.charAt(0).toUpperCase() + profile.slice(1)).classList.add('active');
    }

    // Confirmar selecao de perfil
    function confirmarPerfil() {
      // Atualizar card na sidebar
      const icon = document.getElementById('profileIcon');
      const name = document.getElementById('profileName');
      const tag = document.getElementById('profileTag');

      if (selectedProfile === 'emissor') {
        icon.className = 'profile-mode-icon emissor';
        icon.innerHTML = '<i class="bi bi-broadcast"></i>';
        name.textContent = 'Emissor';
        tag.className = 'profile-mode-tag emissor';
        tag.innerHTML = '<i class="bi bi-broadcast"></i> Emissor';
      } else {
        icon.className = 'profile-mode-icon distribuidor';
        icon.innerHTML = '<i class="bi bi-diagram-3"></i>';
        name.textContent = 'Distribuidor';
        tag.className = 'profile-mode-tag distribuidor';
        tag.innerHTML = '<i class="bi bi-diagram-3"></i> Distrib.';
      }

      // Atualizar conteudo da pagina
      switchProfileContent(selectedProfile);

      // Fechar modal
      hideModal('selecionarPerfilModal');

      // Salvar preferencia
      localStorage.setItem('parceiro_profile', selectedProfile);
    }

    // Trocar conteudo baseado no perfil
    function switchProfileContent(profile) {
      const emissorContent = document.querySelectorAll('.emissor-content');
      const distribuidorContent = document.querySelectorAll('.distribuidor-content');
      const pageTitle = document.querySelector('.page-title');
      const pageSubtitle = document.querySelector('.page-header .text-muted');

      if (profile === 'emissor') {
        emissorContent.forEach(el => el.style.display = '');
        distribuidorContent.forEach(el => el.style.display = 'none');
        if (pageTitle) pageTitle.textContent = 'Ola, TechStart!';
        if (pageSubtitle) pageSubtitle.textContent = 'Acompanhe sua oferta em tempo real';
      } else {
        emissorContent.forEach(el => el.style.display = 'none');
        distribuidorContent.forEach(el => el.style.display = '');
        if (pageTitle) pageTitle.textContent = 'Portal Distribuidor';
        if (pageSubtitle) pageSubtitle.textContent = 'Distribua ofertas para seus clientes';
      }
    }

    // Inicializar perfil salvo
    document.addEventListener('DOMContentLoaded', function() {
      const saved = localStorage.getItem('parceiro_profile') || 'emissor';
      selectedProfile = saved;
      selectProfileOption(saved);
      confirmarPerfil();
    });
  </script>
</body>
</html>
