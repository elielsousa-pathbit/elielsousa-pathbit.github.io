<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Nova Oferta - Admin - CrowdInvest</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  <link rel="stylesheet" href="../../css/style.css">
</head>
<body class="theme-admin">
  <div class="dashboard">
    <aside class="sidebar sidebar-dark">
      <div class="sidebar-logo">
        <a href="../../index.html" class="logo" style="color: white;">CrowdInvest</a>
        <span class="badge badge-warning" style="margin-left: 10px;">Admin</span>
      </div>
      <ul class="sidebar-menu">
        <li><a href="dashboard.html"><i class="bi bi-speedometer2"></i> Dashboard</a></li>
        <li><a href="ofertas.html" class="active"><i class="bi bi-megaphone"></i> Ofertas</a></li>
        <li><a href="clientes.html"><i class="bi bi-people"></i> Clientes</a></li>
        <li><a href="kyc-fila.html"><i class="bi bi-person-check"></i> Validacao Cadastro</a></li>
        <li><a href="moderacao.html"><i class="bi bi-shield-check"></i> Moderacao</a></li>
        <li><a href="parceiros.html"><i class="bi bi-building"></i> Parceiros</a></li>
        <li><a href="imposto-renda.html"><i class="bi bi-file-earmark-text"></i> Imposto de Renda</a></li>
        <li><a href="relatorios.html"><i class="bi bi-bar-chart"></i> Relatorios</a></li>
        <li><a href="configuracoes.html"><i class="bi bi-gear"></i> Configuracoes</a></li>
        <li><a href="../admin-login.html"><i class="bi bi-box-arrow-left"></i> Sair</a></li>
      </ul>
    </aside>
    <div class="mobile-overlay" onclick="closeMobileMenus()"></div>

    <main class="main-content">
      <button class="menu-toggle" onclick="toggleSidebar()"><i class="bi bi-list"></i><span> Menu</span></button>

      <div class="page-header">
        <div class="flex gap-10" style="align-items: center;">
          <a href="ofertas.html" class="btn btn-outline btn-sm"><i class="bi bi-arrow-left"></i></a>
          <div>
            <h1 class="page-title">Nova Oferta de Captacao</h1>
            <p class="text-muted">Criar oferta em nome de um parceiro</p>
          </div>
        </div>
      </div>

      <!-- Alert Info -->
      <div class="alert alert-warning mb-20">
        <i class="bi bi-exclamation-triangle"></i> <strong>Atencao:</strong> Esta funcao cria uma oferta em nome de um parceiro cadastrado. O parceiro sera notificado e devera aprovar a oferta antes de ser publicada.
      </div>

      <!-- Step 1 - Selecionar Parceiro -->
      <div class="card mb-20">
        <div class="card-header">
          <h3 class="card-title"><i class="bi bi-building"></i> 1. Selecionar Parceiro</h3>
        </div>

        <div class="form-group">
          <label class="form-label">Parceiro/Emissor *</label>
          <select class="form-input" id="selectParceiro" onchange="loadParceiroData()">
            <option value="">Selecione um parceiro cadastrado...</option>
            <option value="1">TechStart Inovacao LTDA - 12.345.678/0001-90</option>
            <option value="2">EcoFood Organicos SA - 23.456.789/0001-01</option>
            <option value="3">MedTech Diagnosticos SA - 34.567.890/0001-12</option>
            <option value="4">AgriSmart LTDA - 45.678.901/0001-23</option>
            <option value="5">FinanceApp LTDA - 56.789.012/0001-34</option>
          </select>
          <small class="text-muted">Somente parceiros com cadastro aprovado e sem oferta ativa</small>
        </div>

        <div id="parceiroInfo" style="display: none; margin-top: 20px; padding: 20px; background: var(--bg); border-radius: var(--radius);">
          <div class="flex gap-20" style="align-items: flex-start;">
            <div style="width: 60px; height: 60px; background: linear-gradient(135deg, #059669, #047857); border-radius: 12px; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 1.5rem;">TS</div>
            <div style="flex: 1;">
              <h4 style="margin: 0;">TechStart Inovacao LTDA</h4>
              <p class="text-muted" style="margin: 5px 0;">CNPJ: 12.345.678/0001-90 | Tecnologia / SaaS</p>
              <div class="flex gap-10 mt-10">
                <span class="badge badge-success"><i class="bi bi-check-circle"></i> Cadastro Aprovado</span>
                <span class="badge badge-info"><i class="bi bi-calendar"></i> Desde 15/03/2024</span>
                <span class="badge"><i class="bi bi-megaphone"></i> 0 ofertas ativas</span>
              </div>
            </div>
            <a href="parceiro-detalhe.html" class="btn btn-outline btn-sm"><i class="bi bi-eye"></i> Ver Perfil</a>
          </div>
        </div>
      </div>

      <!-- Step 2 - Tipo de Oferta -->
      <div class="card mb-20">
        <div class="card-header">
          <h3 class="card-title"><i class="bi bi-tags"></i> 2. Tipo de Oferta</h3>
        </div>

        <div class="grid-2" style="gap: 15px;">
          <label class="form-group" style="padding: 20px; border: 2px solid var(--primary); border-radius: var(--radius); cursor: pointer; background: rgba(37, 99, 235, 0.05);">
            <input type="radio" name="tipoOferta" value="equity" checked style="margin-right: 10px;">
            <strong style="color: #7c3aed;"><i class="bi bi-graph-up"></i> Equity (Participacao)</strong>
            <p class="text-muted" style="margin: 10px 0 0; font-size: 0.875rem;">Clientes recebem participacao societaria na empresa.</p>
          </label>
          <label class="form-group" style="padding: 20px; border: 2px solid var(--border); border-radius: var(--radius); cursor: pointer;">
            <input type="radio" name="tipoOferta" value="cri" style="margin-right: 10px;">
            <strong style="color: #0891b2;"><i class="bi bi-building"></i> CRI (Imobiliario)</strong>
            <p class="text-muted" style="margin: 10px 0 0; font-size: 0.875rem;">Certificado de Recebiveis Imobiliarios - Renda Fixa.</p>
          </label>
          <label class="form-group" style="padding: 20px; border: 2px solid var(--border); border-radius: var(--radius); cursor: pointer;">
            <input type="radio" name="tipoOferta" value="cra" style="margin-right: 10px;">
            <strong style="color: #22c55e;"><i class="bi bi-tree"></i> CRA (Agronegocio)</strong>
            <p class="text-muted" style="margin: 10px 0 0; font-size: 0.875rem;">Certificado de Recebiveis do Agronegocio - Renda Fixa.</p>
          </label>
          <label class="form-group" style="padding: 20px; border: 2px solid var(--border); border-radius: var(--radius); cursor: pointer;">
            <input type="radio" name="tipoOferta" value="cr" style="margin-right: 10px;">
            <strong style="color: #f59e0b;"><i class="bi bi-cash-stack"></i> CR (Outros)</strong>
            <p class="text-muted" style="margin: 10px 0 0; font-size: 0.875rem;">Certificado de Recebiveis - Outros setores.</p>
          </label>
        </div>
      </div>

      <!-- Step 3 - Dados da Oferta -->
      <div class="card mb-20">
        <div class="card-header">
          <h3 class="card-title"><i class="bi bi-clipboard-data"></i> 3. Dados da Oferta</h3>
        </div>

        <form id="novaOfertaForm">
          <div class="grid-2" style="gap: 20px;">
            <div class="form-group">
              <label class="form-label">Nome da Oferta *</label>
              <input type="text" class="form-input" placeholder="Ex: TechStart Serie A" required>
            </div>
            <div class="form-group">
              <label class="form-label">Setor/Categoria *</label>
              <select class="form-input" required>
                <option value="">Selecione...</option>
                <option value="tecnologia">Tecnologia / SaaS</option>
                <option value="fintech">Fintech</option>
                <option value="healthtech">Healthtech</option>
                <option value="edtech">Edtech</option>
                <option value="ecommerce">E-commerce</option>
                <option value="foodtech">Foodtech</option>
                <option value="imobiliario">Imobiliario</option>
                <option value="agronegocio">Agronegocio</option>
                <option value="energia">Energia</option>
                <option value="outros">Outros</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">Meta de Captacao (R$) *</label>
              <input type="text" class="form-input" placeholder="500.000" required>
              <small class="text-muted">Maximo: R$ 15.000.000 (RCVM 88/2022)</small>
            </div>
            <div class="form-group">
              <label class="form-label">Meta Minima (R$) *</label>
              <input type="text" class="form-input" placeholder="250.000" required>
              <small class="text-muted">Valor minimo para sucesso da oferta (2/3 da meta)</small>
            </div>
            <div class="form-group">
              <label class="form-label">Investimento Minimo (R$) *</label>
              <input type="text" class="form-input" placeholder="1.000" required>
            </div>
            <div class="form-group">
              <label class="form-label">Prazo de Captacao (dias) *</label>
              <input type="number" class="form-input" value="90" min="30" max="180" required>
              <small class="text-muted">Maximo: 180 dias (RCVM 88/2022)</small>
            </div>
          </div>

          <!-- Equity Fields -->
          <div id="equityFields" style="margin-top: 20px; padding: 20px; background: rgba(124, 58, 237, 0.05); border-radius: var(--radius); border: 1px solid rgba(124, 58, 237, 0.2);">
            <h4 style="margin-bottom: 15px; color: #7c3aed;"><i class="bi bi-graph-up"></i> Dados de Equity</h4>
            <div class="grid-2" style="gap: 20px;">
              <div class="form-group">
                <label class="form-label">Participacao Oferecida (%) *</label>
                <input type="number" class="form-input" placeholder="10" min="0.1" max="49.9" step="0.1">
                <small class="text-muted">Maximo 49,9% (controle permanece com fundadores)</small>
              </div>
              <div class="form-group">
                <label class="form-label">Valuation Pre-Money (R$) *</label>
                <input type="text" class="form-input" placeholder="5.000.000">
              </div>
            </div>
          </div>

          <!-- Renda Fixa Fields (hidden by default) -->
          <div id="rendaFixaFields" style="display: none; margin-top: 20px; padding: 20px; background: rgba(8, 145, 178, 0.05); border-radius: var(--radius); border: 1px solid rgba(8, 145, 178, 0.2);">
            <h4 style="margin-bottom: 15px; color: #0891b2;"><i class="bi bi-percent"></i> Dados de Renda Fixa</h4>
            <div class="grid-2" style="gap: 20px;">
              <div class="form-group">
                <label class="form-label">Indexador *</label>
                <select class="form-input">
                  <option value="cdi">CDI</option>
                  <option value="ipca">IPCA</option>
                  <option value="prefixado">Prefixado</option>
                </select>
              </div>
              <div class="form-group">
                <label class="form-label">Taxa (% a.a.) *</label>
                <input type="number" class="form-input" placeholder="4.5" step="0.1">
                <small class="text-muted">Spread sobre o indexador</small>
              </div>
              <div class="form-group">
                <label class="form-label">Prazo do Titulo (meses) *</label>
                <input type="number" class="form-input" placeholder="24" min="6" max="120">
              </div>
              <div class="form-group">
                <label class="form-label">Pagamento de Juros *</label>
                <select class="form-input">
                  <option value="mensal">Mensal</option>
                  <option value="semestral">Semestral</option>
                  <option value="anual">Anual</option>
                  <option value="vencimento">No Vencimento</option>
                </select>
              </div>
              <div class="form-group">
                <label class="form-label">Tipo de Amortizacao *</label>
                <select class="form-input">
                  <option value="bullet">Bullet (no vencimento)</option>
                  <option value="sac">SAC</option>
                  <option value="price">Price</option>
                </select>
              </div>
              <div class="form-group">
                <label class="form-label">Garantia Principal *</label>
                <input type="text" class="form-input" placeholder="Ex: Alienacao Fiduciaria, Penhor de Safra">
              </div>
            </div>
          </div>

          <div class="form-group mt-20">
            <label class="form-label">Descricao da Oferta *</label>
            <textarea class="form-input" rows="4" required placeholder="Descreva os objetivos da captacao, uso dos recursos, diferenciais competitivos..."></textarea>
          </div>

          <hr style="margin: 30px 0; border: none; border-top: 1px solid var(--border);">

          <!-- Step 4 - Documentos -->
          <div class="card-header" style="padding: 0; border: none; margin-bottom: 20px;">
            <h3 class="card-title"><i class="bi bi-folder"></i> 4. Documentos Obrigatorios</h3>
          </div>

          <div class="alert alert-info mb-20">
            <i class="bi bi-info-circle"></i> Todos os documentos serao validados pela equipe de compliance antes da aprovacao.
          </div>

          <div style="display: flex; flex-direction: column; gap: 15px;">
            <div style="padding: 15px; background: var(--bg); border-radius: var(--radius); border-left: 4px solid var(--primary);">
              <div class="flex-between">
                <div>
                  <strong><i class="bi bi-file-earmark-pdf"></i> Contrato Social Atualizado</strong>
                  <p class="text-muted" style="font-size: 0.875rem; margin: 5px 0 0;">PDF - Maximo 10MB</p>
                </div>
                <div class="flex gap-10">
                  <button type="button" class="btn btn-outline btn-sm"><i class="bi bi-upload"></i> Upload</button>
                  <span class="badge badge-secondary">Pendente</span>
                </div>
              </div>
            </div>
            <div style="padding: 15px; background: var(--bg); border-radius: var(--radius); border-left: 4px solid var(--primary);">
              <div class="flex-between">
                <div>
                  <strong><i class="bi bi-file-earmark-pdf"></i> Demonstracoes Financeiras</strong>
                  <p class="text-muted" style="font-size: 0.875rem; margin: 5px 0 0;">Ultimos 2 anos - PDF - Maximo 20MB</p>
                </div>
                <div class="flex gap-10">
                  <button type="button" class="btn btn-outline btn-sm"><i class="bi bi-upload"></i> Upload</button>
                  <span class="badge badge-secondary">Pendente</span>
                </div>
              </div>
            </div>
            <div style="padding: 15px; background: var(--bg); border-radius: var(--radius); border-left: 4px solid var(--primary);">
              <div class="flex-between">
                <div>
                  <strong><i class="bi bi-file-earmark-pdf"></i> Business Plan / Pitch Deck</strong>
                  <p class="text-muted" style="font-size: 0.875rem; margin: 5px 0 0;">PDF ou PPTX - Maximo 30MB</p>
                </div>
                <div class="flex gap-10">
                  <button type="button" class="btn btn-outline btn-sm"><i class="bi bi-upload"></i> Upload</button>
                  <span class="badge badge-secondary">Pendente</span>
                </div>
              </div>
            </div>
            <div style="padding: 15px; background: var(--bg); border-radius: var(--radius); border-left: 4px solid var(--success);">
              <div class="flex-between">
                <div>
                  <strong><i class="bi bi-file-earmark-pdf"></i> Termo de Adesao RCVM 88</strong>
                  <p class="text-muted" style="font-size: 0.875rem; margin: 5px 0 0;">Modelo padrao da plataforma</p>
                </div>
                <div class="flex gap-10">
                  <button type="button" class="btn btn-outline btn-sm"><i class="bi bi-download"></i> Baixar Modelo</button>
                  <span class="badge badge-success"><i class="bi bi-check"></i> Gerado</span>
                </div>
              </div>
            </div>
          </div>

          <hr style="margin: 30px 0; border: none; border-top: 1px solid var(--border);">

          <!-- Opcoes Admin -->
          <div class="card-header" style="padding: 0; border: none; margin-bottom: 20px;">
            <h3 class="card-title"><i class="bi bi-sliders"></i> 5. Opcoes Administrativas</h3>
          </div>

          <div class="grid-2" style="gap: 20px;">
            <div class="form-group">
              <label class="form-label">Status Inicial *</label>
              <select class="form-input">
                <option value="rascunho">Rascunho (nao visivel)</option>
                <option value="aguardando" selected>Aguardando Aprovacao Parceiro</option>
                <option value="analise">Em Analise Compliance</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">Prioridade de Analise</label>
              <select class="form-input">
                <option value="normal" selected>Normal</option>
                <option value="alta">Alta</option>
                <option value="urgente">Urgente</option>
              </select>
            </div>
          </div>

          <div class="form-group">
            <label class="form-label">Notas Internas (opcional)</label>
            <textarea class="form-input" rows="3" placeholder="Observacoes para a equipe de analise..."></textarea>
          </div>

          <div class="form-group">
            <label style="display: flex; align-items: center; gap: 10px;">
              <input type="checkbox" checked>
              <span>Notificar parceiro por e-mail sobre a criacao da oferta</span>
            </label>
          </div>

          <hr style="margin: 30px 0; border: none; border-top: 1px solid var(--border);">

          <div class="flex-between">
            <a href="ofertas.html" class="btn btn-outline">Cancelar</a>
            <div class="flex gap-10">
              <button type="button" class="btn btn-outline" onclick="salvarRascunho()">
                <i class="bi bi-save"></i> Salvar Rascunho
              </button>
              <button type="submit" class="btn btn-primary" onclick="criarOferta(event)">
                <i class="bi bi-plus-lg"></i> Criar Oferta
              </button>
            </div>
          </div>
        </form>
      </div>
    </main>
  </div>

  <script src="../../js/app.js"></script>

  <!-- Modal Sucesso -->
  <div class="modal-overlay" id="sucessoModal" style="display: none;">
    <div class="modal text-center" style="max-width: 450px;">
      <div style="padding: 30px;">
        <div style="width: 80px; height: 80px; background: rgba(34, 197, 94, 0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px;">
          <i class="bi bi-check-circle" style="font-size: 3rem; color: var(--success);"></i>
        </div>
        <h3 style="margin-bottom: 10px;">Oferta Criada com Sucesso!</h3>
        <p class="text-muted">A oferta foi criada e o parceiro sera notificado para aprovar os termos.</p>
        <div style="background: var(--bg); padding: 15px; border-radius: var(--radius); margin: 20px 0;">
          <p style="margin: 0;"><strong>Codigo da Oferta:</strong> OFR-2026-0089</p>
          <p style="margin: 5px 0 0;" class="text-muted">Status: Aguardando Aprovacao Parceiro</p>
        </div>
        <div class="flex gap-10" style="justify-content: center;">
          <a href="ofertas.html" class="btn btn-outline">Voltar para Ofertas</a>
          <a href="oferta-analise.html" class="btn btn-primary">Ver Oferta</a>
        </div>
      </div>
    </div>
  </div>

  <script>
    function loadParceiroData() {
      const select = document.getElementById('selectParceiro');
      const info = document.getElementById('parceiroInfo');
      if (select.value) {
        info.style.display = 'block';
      } else {
        info.style.display = 'none';
      }
    }

    // Toggle between Equity and Renda Fixa fields
    document.querySelectorAll('input[name="tipoOferta"]').forEach(radio => {
      radio.addEventListener('change', function() {
        const equityFields = document.getElementById('equityFields');
        const rendaFixaFields = document.getElementById('rendaFixaFields');

        document.querySelectorAll('input[name="tipoOferta"]').forEach(r => {
          r.closest('label').style.borderColor = 'var(--border)';
          r.closest('label').style.background = 'transparent';
        });
        this.closest('label').style.borderColor = 'var(--primary)';
        this.closest('label').style.background = 'rgba(37, 99, 235, 0.05)';

        if (this.value === 'equity') {
          equityFields.style.display = 'block';
          rendaFixaFields.style.display = 'none';
        } else {
          equityFields.style.display = 'none';
          rendaFixaFields.style.display = 'block';
        }
      });
    });

    function salvarRascunho() {
      showModal('rascunhoModal');
    }

    function criarOferta(e) {
      e.preventDefault();
      showModal('sucessoModal');
    }
  </script>

  <!-- Modal Rascunho -->
  <div class="modal-overlay" id="rascunhoModal" style="display: none;">
    <div class="modal text-center" style="max-width: 400px;">
      <div style="padding: 30px;">
        <i class="bi bi-save" style="font-size: 3rem; color: var(--primary);"></i>
        <h3 style="margin: 15px 0;">Rascunho Salvo!</h3>
        <p class="text-muted">Voce pode continuar editando a oferta depois.</p>
        <button class="btn btn-primary mt-20" onclick="hideModal('rascunhoModal')">OK</button>
      </div>
    </div>
  </div>
</body>
</html>
